import requests


class cve:

    url = ''

    params = dict()

    def __init__(self, url, params):
        cve.url = url
        cve.params = params

    def parser(self, data):
        result = dict()
        counter = 0
        while (counter < len(data['vulnerabilities'])):
            cve_number = data['vulnerabilities'][counter]['cve']['id']
            des = data['vulnerabilities'][counter]['cve']['descriptions'][0]['value']
            message = "CVE: " + cve_number+"\n"+"DESCRIPTION:  "+des+"\n \n \n \n"
            result[counter] = message
            counter = counter+1

        return result

    def get(self):
        resp = requests.get(cve.url, cve.params)
        data = resp.json()  # Check the JSON Response Content documentation below
        result = cve.parser(self, data)
        return result
